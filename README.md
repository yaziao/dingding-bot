# ğŸŒ¤ï¸ å¤©æ°”æ’­æŠ¥æœºå™¨äºº

ä¸€ä¸ªåŸºäºPythonçš„æ™ºèƒ½å¤©æ°”æ’­æŠ¥æœºå™¨äººï¼Œä½¿ç”¨å½©ç‰å¤©æ°”APIè·å–å®æ—¶å¤©æ°”æ•°æ®ï¼Œå¹¶é€šè¿‡é’‰é’‰æœºå™¨äººå®šæ—¶æ¨é€ç¾åŒ–åçš„å¤©æ°”ä¿¡æ¯åˆ°é’‰é’‰ç¾¤ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸŒ¡ï¸ **å®æ—¶å¤©æ°”æ•°æ®**ï¼šé›†æˆå½©ç‰å¤©æ°”APIï¼Œè·å–å‡†ç¡®çš„å¤©æ°”ä¿¡æ¯
- ğŸ¤– **é’‰é’‰æœºå™¨äººæ¨é€**ï¼šæ”¯æŒæ–‡æœ¬å’ŒMarkdownæ ¼å¼çš„æ¶ˆæ¯æ¨é€
- â° **å®šæ—¶ä»»åŠ¡è°ƒåº¦**ï¼šå¯é…ç½®ä»»æ„é—´éš”çš„å®šæ—¶æ’­æŠ¥
- ğŸ¨ **ç¾åŒ–æ¶ˆæ¯æ ¼å¼**ï¼šä¸°å¯Œçš„emojiå’Œç»“æ„åŒ–å¸ƒå±€
- ğŸ« **ç©ºæ°”è´¨é‡ç›‘æµ‹**ï¼šåŒ…å«AQIã€PM2.5ã€PM10ç­‰ç©ºæ°”è´¨é‡æŒ‡æ ‡
- ğŸ’¡ **æ™ºèƒ½æé†’**ï¼šæ ¹æ®å¤©æ°”çŠ¶å†µæä¾›è´´å¿ƒçš„ç”Ÿæ´»å»ºè®®
- ğŸ“Š **è¯¦ç»†å¤©æ°”ä¿¡æ¯**ï¼šæ¸©åº¦ã€æ¹¿åº¦ã€é£å‘é£é€Ÿã€èƒ½è§åº¦ã€æ°”å‹ç­‰
- ğŸ›¡ï¸ **é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œæ—¥å¿—è®°å½•

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- Python 3.12+
- uv åŒ…ç®¡ç†å™¨

### 2. å®‰è£…ä¾èµ–

```bash
# ä½¿ç”¨uvå®‰è£…ä¾èµ–
uv pip install -e .

# æˆ–ä½¿ç”¨pip
pip install -e .
```

### 3. é…ç½®è®¾ç½®

1. **å¤åˆ¶é…ç½®æ¨¡æ¿**ï¼š
   ```bash
   cp config.example .env
   ```

2. **ç¼–è¾‘é…ç½®æ–‡ä»¶**ï¼Œå¡«å…¥ä»¥ä¸‹ä¿¡æ¯ï¼š
   ```bash
   # å½©ç‰å¤©æ°”APIé…ç½®
   CAIYUN_API_KEY=your_caiyun_api_key_here
   
   # ä½ç½®ä¿¡æ¯ (ç»åº¦,çº¬åº¦)
   LONGITUDE=116.4074
   LATITUDE=39.9042
   
   # é’‰é’‰æœºå™¨äººWebhooké…ç½®
   DINGTALK_WEBHOOK=https://oapi.dingtalk.com/robot/send?access_token=your_access_token_here
   DINGTALK_SECRET=your_secret_here  # å¯é€‰
   
   # åŸå¸‚åç§°
   CITY_NAME=åŒ—äº¬
   ```

### 4. è·å–APIå¯†é’¥å’ŒWebhook

#### å½©ç‰å¤©æ°”API
1. è®¿é—® [å½©ç‰å¤©æ°”å¼€å‘å¹³å°](https://dashboard.caiyunapp.com/)
2. æ³¨å†Œè´¦å·å¹¶åˆ›å»ºåº”ç”¨
3. è·å–APIå¯†é’¥

#### é’‰é’‰æœºå™¨äºº
1. åœ¨é’‰é’‰ç¾¤ä¸­æ·»åŠ "è‡ªå®šä¹‰æœºå™¨äºº"
2. å¤åˆ¶Webhookåœ°å€
3. å¦‚éœ€å®‰å…¨è®¾ç½®ï¼Œå¯å¯ç”¨"åŠ ç­¾"åŠŸèƒ½å¹¶è·å–å¯†é’¥

### 5. è·å–åœ°ç†åæ ‡
- è®¿é—® [é«˜å¾·åœ°å›¾åæ ‡æ‹¾å–å·¥å…·](https://lbs.amap.com/tools/picker)
- æœç´¢ç›®æ ‡åŸå¸‚ï¼Œè·å–ç»çº¬åº¦åæ ‡

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ä¾¿æ·å¯åŠ¨å™¨ï¼ˆæ¨èï¼‰
```bash
python run.py
```
å¯åŠ¨å™¨ä¼šå¼•å¯¼æ‚¨å®Œæˆé…ç½®å¹¶é€‰æ‹©è¿è¡Œæ¨¡å¼ã€‚

### æ–¹æ³•äºŒï¼šç›´æ¥è¿è¡Œ
```bash
# æµ‹è¯•æ¨¡å¼ï¼ˆå‘é€ä¸€æ¬¡æµ‹è¯•æ¶ˆæ¯ï¼‰
python main.py --test

# å®šæ—¶æ¨¡å¼ï¼ˆæ¯å°æ—¶å‘é€ï¼‰
python main.py

# è‡ªå®šä¹‰é—´éš”ï¼ˆæ¯3å°æ—¶å‘é€ï¼‰
python main.py --interval 3
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
dingding/
â”œâ”€â”€ main.py              # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ run.py               # ä¾¿æ·å¯åŠ¨å™¨
â”œâ”€â”€ pyproject.toml       # é¡¹ç›®é…ç½®å’Œä¾èµ–
â”œâ”€â”€ config.example       # é…ç½®æ–‡ä»¶æ¨¡æ¿
â”œâ”€â”€ README.md           # ä½¿ç”¨è¯´æ˜
â”œâ”€â”€ .gitignore          # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ logs/               # æ—¥å¿—ç›®å½•
â””â”€â”€ src/                # æºä»£ç ç›®å½•
    â”œâ”€â”€ __init__.py     # åŒ…åˆå§‹åŒ–
    â”œâ”€â”€ config.py       # é…ç½®ç®¡ç†
    â”œâ”€â”€ weather.py      # å¤©æ°”APIè°ƒç”¨
    â”œâ”€â”€ dingtalk.py     # é’‰é’‰æœºå™¨äººæ¨é€
    â”œâ”€â”€ formatter.py    # æ¶ˆæ¯æ ¼å¼åŒ–
    â””â”€â”€ scheduler.py    # å®šæ—¶ä»»åŠ¡è°ƒåº¦
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®

| å˜é‡å | å¿…å¡« | æè¿° | ç¤ºä¾‹ |
|--------|------|------|------|
| `CAIYUN_API_KEY` | âœ… | å½©ç‰å¤©æ°”APIå¯†é’¥ | `your_api_key_here` |
| `LONGITUDE` | âœ… | ç›®æ ‡ä½ç½®ç»åº¦ | `116.4074` |
| `LATITUDE` | âœ… | ç›®æ ‡ä½ç½®çº¬åº¦ | `39.9042` |
| `DINGTALK_WEBHOOK` | âœ… | é’‰é’‰æœºå™¨äººWebhookåœ°å€ | `https://oapi.dingtalk.com/robot/send?access_token=xxx` |
| `DINGTALK_SECRET` | âŒ | é’‰é’‰æœºå™¨äººå¯†é’¥ï¼ˆåŠ ç­¾ï¼‰ | `your_secret_here` |
| `CITY_NAME` | âŒ | åŸå¸‚æ˜¾ç¤ºåç§° | `åŒ—äº¬` |

### å‘½ä»¤è¡Œå‚æ•°

| å‚æ•° | æè¿° | é»˜è®¤å€¼ |
|------|------|--------|
| `--interval` | æ’­æŠ¥é—´éš”ï¼ˆå°æ—¶ï¼‰ | `1` |
| `--test` | æµ‹è¯•æ¨¡å¼ï¼Œå‘é€ä¸€æ¬¡æ¶ˆæ¯åé€€å‡º | `False` |
| `--config` | æŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„ | è‡ªåŠ¨æ£€æµ‹ |

## ğŸ“± æ¶ˆæ¯æ•ˆæœé¢„è§ˆ

### Markdownæ ¼å¼æ¶ˆæ¯
```
## â˜€ï¸ åŒ—äº¬å¤©æ°”å®å†µ

> ğŸ“… æ›´æ–°æ—¶é—´ï¼š2024-01-15 14:00

---

### ğŸŒ¡ï¸ åŸºæœ¬ä¿¡æ¯
- **æ¸©åº¦ï¼š** 15.2Â°C ğŸ˜Š å‡‰çˆ½
- **å¤©æ°”ï¼š** â˜€ï¸ æ™´å¤©  
- **æ¹¿åº¦ï¼š** ğŸ’§ 45.0%
- **é£å‘é£é€Ÿï¼š** ğŸ’¨ è¥¿åŒ—é£ 3.2m/s
- **èƒ½è§åº¦ï¼š** ğŸ‘ï¸ 10.0km
- **æ°”å‹ï¼š** ğŸ”ï¸ 1013.2hPa

### ğŸ« ç©ºæ°”è´¨é‡
- **AQIï¼š** ğŸŸ¢ 35 (ä¼˜)
- **PM2.5ï¼š** ğŸ”¹ 12.5Î¼g/mÂ³
- **PM10ï¼š** ğŸ”¸ 25.0Î¼g/mÂ³

### ğŸ’¡ æ¸©é¦¨æç¤º
- ğŸŒˆ å¤©æ°”ä¸é”™ï¼Œé€‚åˆå¤–å‡ºæ´»åŠ¨ï¼
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **APIè°ƒç”¨å¤±è´¥**
   - æ£€æŸ¥å½©ç‰å¤©æ°”APIå¯†é’¥æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤APIè°ƒç”¨æ¬¡æ•°æ˜¯å¦å·²ç”¨å®Œ
   - æ£€æŸ¥ç½‘ç»œè¿æ¥

2. **é’‰é’‰æ¶ˆæ¯å‘é€å¤±è´¥**
   - éªŒè¯Webhookåœ°å€æ˜¯å¦æ­£ç¡®
   - æ£€æŸ¥æœºå™¨äººæ˜¯å¦è¢«ç§»é™¤
   - ç¡®è®¤åŠ ç­¾å¯†é’¥é…ç½®

3. **åæ ‡è·å–å¤©æ°”å¤±è´¥**
   - ç¡®è®¤ç»çº¬åº¦æ ¼å¼æ­£ç¡®
   - æ£€æŸ¥åæ ‡æ˜¯å¦åœ¨å½©ç‰å¤©æ°”æ”¯æŒèŒƒå›´å†…

### æ—¥å¿—æŸ¥çœ‹

ç¨‹åºä¼šè‡ªåŠ¨ç”Ÿæˆæ—¥å¿—æ–‡ä»¶ï¼š
- æ§åˆ¶å°è¾“å‡ºï¼šå®æ—¶æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
- æ–‡ä»¶æ—¥å¿—ï¼š`logs/weather_bot.log`
- æ—¥å¿—è½®è½¬ï¼šæ¯å¤©ä¸€ä¸ªæ–‡ä»¶ï¼Œä¿ç•™30å¤©

## ğŸ”„ éƒ¨ç½²å»ºè®®

### æœåŠ¡å™¨éƒ¨ç½²
```bash
# ä½¿ç”¨screenæˆ–tmuxä¿æŒåå°è¿è¡Œ
screen -S weather-bot
python main.py --interval 1

# æˆ–ä½¿ç”¨nohup
nohup python main.py --interval 1 > weather_bot.log 2>&1 &
```

### ä½¿ç”¨systemdæœåŠ¡ï¼ˆæ¨èï¼‰
```bash
# åˆ›å»ºæœåŠ¡æ–‡ä»¶
sudo nano /etc/systemd/system/weather-bot.service

# å¯åŠ¨æœåŠ¡
sudo systemctl enable weather-bot
sudo systemctl start weather-bot
```

### Dockeréƒ¨ç½²
```dockerfile
FROM python:3.12-slim
WORKDIR /app
COPY . .
RUN pip install -e .
CMD ["python", "main.py"]
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

1. Forkæœ¬é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. å‘èµ·Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- [å½©ç‰å¤©æ°”](https://caiyunapp.com/) - æä¾›å‡†ç¡®çš„å¤©æ°”æ•°æ®API
- [é’‰é’‰å¼€æ”¾å¹³å°](https://developers.dingtalk.com/) - æä¾›æœºå™¨äººæ¨é€èƒ½åŠ›
- æ‰€æœ‰å¼€æºä¾èµ–åº“çš„è´¡çŒ®è€…

---

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æäº¤Issueï¼ ğŸŒŸ
